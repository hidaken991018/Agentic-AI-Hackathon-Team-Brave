# Git 運用ルール

## 1. 基本方針

- **GitHub Flow** をベースとする。
- すべての変更（コード、ドキュメント、AI 設定、cloud 環境設定）は、必ず issue と紐づけてブランチを切り Pull Request (PR) を通す。
- **「マージ ＝ 本番デプロイ可能」** な状態を常に維持する。
- マージ後はブランチ削除
- デプロイはリリースタグ付与のタイミングとする(命名規則は後述。)

## 2. ブランチ命名規則

作業内容が一目でわかるよう、接頭辞（プレフィックス）を使用する。

| 接頭辞         | 用途                                                             | 例                           |
| -------------- | ---------------------------------------------------------------- | ---------------------------- |
| **`feature/`** | アプリの機能に影響する修正(機能開発、AI プロンプト調整、DB 変更) | `feature/12-ai-chat-logic`   |
| **`fix/`**     | バグ修正                                                         | `fix/34-db-connection-error` |
| **`docs/`**    | 機能に影響ない修正(README、仕様書、API ドキュメント更新)         | `docs/5-setup-guide`         |

- **ルール:** `接頭辞/Issue番号-簡潔な内容`
- **理由:** Issue 番号を入れることで、タスクとの紐付けを明確にする

## 3. コミットメッセージのルール

### フォーマット

`type: #Issue番号 内容`

### プレフィックス(type)

- **`feature:`** 新機能、機能変更、AI プロンプト更新
- **`fix:`** バグ修正
- **`docs:`** ドキュメントのみの修正

**例:** `feat: #12 AI応答のdurationログ出力実装`

## 4. プルリクエスト (PR) テンプレート

PR 作成時に以下のテンプレートを使用。ドキュメント更新時も共通。

```markdown
## 📝 対応 Issue

- Fixes # (Issue 番号を記入)

## 🚀 実装内容

- (例: ログの共通関数を追加)

## 🧪 動作確認

- [ ] サーバサイドで関数実行時にログが出力されること

## 📸 キャプチャ

- (UI 変更時のみ)

## ➕ 備考

-
```

## 5. バージョニングのルール

セマンティックバージョニング（vX.Y.Z）の形式でバージョニングを行い、数字を上げる基準は以下とします。
バージョン | 形式 | 上げるタイミング | 備考
-- | -- | -- | --
メジャー | vX.0.0 | 大規模なリニューアル| 今回の開発においてはバージョンは固定になる想定です
マイナー | v1.Y.0 | 機能要件（SR）の追加 | SR 要件追加時にカウントアップしてください
パッチ | v1.1.Z | SR 以外の要件・修正追加 | SR 以外の要件追加もしくは修正追加でデプロイを実行する場合にカウントアップしてください

## 6.リリースタグ命名規則

リリースタグ付与時は基本的に以下の命名としてください。

| 区分             | タグ形式                              | 具体的な命名例 | 発行タイミング                                            |
| ---------------- | ------------------------------------- | -------------- | --------------------------------------------------------- |
| 本番リリース     | v[Major].[Minor].[Patch] (バージョン) | v1.2.0         | 機能要件(SR)の完了時や、バグ修正後に main ブランチ で発行 |
| 開発・動作確認用 | dev-#[Issue 番号]-[通番]              | dev-#42-1      | マージ前に feature ブランチ の状態で動作確認したい時      |

## 7. 開発から完了までのワークフロー

1. **Issue 作成・アサイン**:

   - 作業前に必ず GitHub Issue を作成し、担当者を割り当てる。

2. **ブランチ作成**:

   - `main` から最新の状態を取得し、新しいブランチを切る。

3. **実装・PR 作成**:

   - 修正を行い、PR を作成する

4. **レビュー**:

   - 基本的に**1 名以上**の Approve（承認）を得る。
   - ただプロジェクト進行上待てない場合には提出したレビューを閉じて次に進めていく。

5. **マージ・issue のクローズ**:

   - `main` にマージする。

   - ※補足：PR 本文に `Closes #Issue番号` と記載すると、マージと同時に Issue を自動で閉じることができます。マージ＆デプロイ後の動作確認が不要な場合は自動クローズを使う
